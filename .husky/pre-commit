#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "ğŸ” Running pre-commit checks..."

# Check if we're in backend or mobile
if git diff --cached --name-only | grep -q "^backend/"; then
  echo "ğŸ“¦ Backend changes detected"
  cd backend
  
  echo "  â†’ Type checking..."
  npm run type-check || exit 1
  
  echo "  â†’ Linting..."
  npm run lint || exit 1
  
  echo "  â†’ Running tests..."
  npm test || exit 1
  
  cd ..
fi

if git diff --cached --name-only | grep -q "^mobile/"; then
  echo "ğŸ“± Mobile changes detected"
  cd mobile
  
  echo "  â†’ Type checking..."
  npm run type-check || exit 1
  
  echo "  â†’ Linting..."
  npm run lint || exit 1
  
  cd ..
fi

echo "âœ… Pre-commit checks passed!"
